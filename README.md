# Чат-бот для Twitch с продвинутой модерацией и интерактивными командами

Разработан специально для www.twitch.tv/cluelesstech98 с учетом особенностей канала

Версия 1.1.0

## Содержание
1. [Отказ от ответственности](#Отказ-от-ответственности)
	1. [Юридические аспекты](#Юридические-аспекты)
 	2. [Технические предупреждения](#Технические-предупреждения)
  	3. [Ответственность пользователя](#Ответственность-пользователя)
   	4. [Лицензирование и использование](#Лицензирование-и-использование)
3. [Особенности](#Особенности)
4. [Быстрый старт](#Быстрый-старт)
5. [Настройка](#Настройка)
6. [Добавление бота в чат](#Добавление-бота-в-чат)
7. [Список команд](#Список-команд)
8. [Разработка](#Разработка)
9. [Безопасность](#Безопасность)
10. [Вклад в проект](#Вклад-в-проект)

# Отказ от ответственности
## ⚠️ ВАЖНО: ПРОЧТИТЕ ПЕРЕД ИСПОЛЬЗОВАНИЕМ ⚠️ 

## Юридические аспекты

### Это **неофициальный** проект

> [!WARNING]
> Данный бот НЕ является продуктом или сервисом компании Twitch Interactive, Inc. (Amazon.com, Inc.), это независимый проект с открытым исходным кодом

### Соблюдение правил Twitch

> [!WARNING]
> Вы обязаны соблюдать Условия использования Twitch, Сообществодские правила и все применимые законы вашей страны

### Ответственность за контент

> [!WARNING]
> Пользователь бота несёт полную ответственность за:
>
> - Контент, генерируемый или распространяемый через бота
>
> - Действия бота в чате канала
> 
> - Последствия использования команд модерации

## Технические предупреждения

### Отсутствие гарантий

> [!WARNING]
> Бот предоставляется "как есть", без каких-либо гарантий.
> 
> Файлы node_modules, .env, bot_database.db намеренно не публикуются в открытом доступе из соображений безопасности
>
> Авторы не несут ответственности за:
> 
> - Потерю/утечку данных
>
> - Блокировку канала Twitch
> 
> - Технические сбои и ошибки в работе
> 
> - Ущерб, причинённый использованием бота

### Безопасность токенов

> [!CAUTION]
> ⚠️ НИКОГДА НЕ ДЕЛИТЕСЬ СВОИМИ ТОКЕНАМИ Twitch API. Храните ACCESS_TOKEN и CLIENT_ID в секрете, утечка токенов может привести к компрометации вашего аккаунта Twitch ⚠️

### Настройка фильтров

> [!WARNING]
> Вы самостоятельно настраиваете фильтры запрещённых слов и правил модерации. Убедитесь, что они соответствуют:
>
> - Правилам Twitch
> 
> - Законам вашей страны
> 
> - Локальным требованиям платформы

## Ответственность пользователя

### Тестирование

> [!WARNING]
> Перед использованием на основном канале протестируйте бота:
> 
> - На тестовом канале (условно)
> 
> - В различных сценариях
> 
> - С разными типами пользователей

### Мониторинг

> [!WARNING]
> Рекомендуется регулярно:
>
> - Проверять логи бота
> 
> - Обновлять токены доступа
> 
> - Следить за изменениями в Twitch API
> 
> - Обновлять список запрещённых слов

### Возрастные ограничения

> [!WARNING]
> Использование бота подразумевает, что вы:
> 
> - Достигли возраста, разрешённого для использования Twitch (13+ лет)
>
>  // В тексте кода присутствует ненормативная лексика, 18+
>
> - Имеете право управлять Twitch каналом (от лица владельца или модератора канала)
> 
> - Понимаете риски использования сторонних ботов

## Лицензирование и использование

### Лицензия MIT

> [!WARNING]
> Проект распространяется под лицензией MIT, что означает:
> 
> - Вы можете свободно использовать, изменять и распространять код
>
> - Авторы не несут ответственности за последствия использования
> 
> - Вы обязаны сохранять уведомление об авторских правах

### Используя этот бот, вы подтверждаете, что:

> [!WARNING]
> - Прочитали и однозначно поняли данный отказ от ответственности
> 
> - Принимаете на себя все риски, связанные с использованием
>
> - Обязаны соблюдать правила Twitch и местное законодательство
> 
> - Несёте полную ответственность за действия бота на канале

### Условная рекомендация

> [!IMPORTANT]
> Перед публичным использованием проконсультируйтесь с юристом относительно соответствия вашей деятельности местному законодательству и правилам Twitch.

## Особенности

### Прямая интеграция с Twitch Helix API
- Команды модерации (`!варн`, `!таймаут`, `!бан`) работают через официальный API Twitch, что гарантирует стабильность и соответствие последним требованиям платформы.

### Автоматическая модерация
- Фильтр запрещённых слов – мгновенный таймаут за использование запрещённых слов (список настраивается в `bannedWords.js`).
- Капс-детектор – система предупреждений за чрезмерное использование CAPS.
- Анти-спам – обнаружение и наказание за повторяющиеся сообщения.
- Система предупреждений (`!варн`) – три предупреждения → автоматический таймаут.

### Интерактивные команды
- `!iq` – случайный IQ с сохранением истории в базе данных.
- `!игра` – отображение текущей игры (или "Пока не играем" / "Стрим не в эфире").
- `!followage` – время отслеживания канала (разные форматы для стримера, модераторов, зрителей).
- `!чебыло` – история категорий текущего стрима с продолжительностью.
- `!команды` – вывод списка доступных команд.
- `!подарок` – случайный подарок с механикой "бан-подарка".
- `!+подарок` – добавление нового подарка (только модераторы/стример).
- `!сбросить_подарки` – сброс кэша подарков (только стример).

### Хранение данных
- SQLite база данных – сохраняет IQ пользователей, историю нарушений, категории стримов.
- Кэширование запросов – оптимизация работы с Twitch API.
- Журналирование – детальные логи для отладки.
  
## Быстрый старт

### Предварительные требования

- Node.js 16.x или выше
- Git
- Аккаунт Twitch с доступом к Developer Console

### Установка за пару кликов

- Клонируйте репозиторий

```git clone https://github.com/ваш-логин/twitch-bot.git cd twitch-bot```

- Установите зависимости
  
```npm install```

- Настройте окружение
  
```cp .env.example .env```

- Отредактируйте .env своими данными

- Запустите бота
  
```node bot.js```

## Настройка

- Перейдите на [сайт генератора токенов](https://twitchtokengenerator.com/) (может потребоваться VPN)

- Нажмите кнопку «Generate Token»
  
- В новом окне авторизуйтесь через аккаунт вашего **бота** (не стримера!)

- Выберите необходимые разрешения (scopes):
   - `chat:read` – чтение чата
   - `chat:edit` – отправка сообщений
   - `channel:moderate` – модерация (таймауты, баны)
   - `moderator:manage:banned_users` – управление банами через API
   - `moderator:manage:chat_messages` – удаление сообщений
   - `user:read:email` – получение email (опционально)

- Скопируйте сгенерированный **Access Token** и **Client ID**.

### Конфигурация .env

> ACCESS_TOKEN=ваш_access_token_здесь
> 
> CLIENT_ID=ваш_client_id_здесь
> 
> CHANNEL_NAME=ваш_канал
> 
> BOT_USERNAME=имя_бота
> 
> TELEGRAM_LINK=ссылка_на_telegram (опционально, для команды !тг)

### Необходимые разрешения 

> [!CAUTION]
> Выбирайте ТОЛЬКО необходимые разрешения, в противном случае утечка токена может привести к необратимым последствиям!

> chat:read    # Чтение чата
> 
> chat:edit    # Отправка сообщений
> 
> moderator:read:followers  # Информация о подписчиках
> 
> user:read:email           # Данные пользователей

## Добавление бота в чат

В вашем Twitch чате выполните:

``` /mod имя_вашего_бота ```

Имейте в виду, что после подключения бота к каналу не отображается никакого приветственного/тестового сообщения для уведомления работоспособности, при желании добавьте 

> ### Авторская ремарка 
>
> Данный проект может быть реализован как бот с ответом от лица стримера или модератора канала, на данный момент все инструкции написаны для модератора
>
> Для реализации от лица стримера замените название бота на название канала и обновите токены с Вашего канала

> [!CAUTION]
> Для обеспечения безопасности Вашего канала не рекомендуется использование от лица стримера

## Список команд

### Команды модерации

|Команда|Доступ|Описание|
|:-:|:-:|:-:|
|!варн @ник|Модераторы|Система предупреждений (3 предупреждения → таймаут)|
|!timeout @ник секунды|Модераторы|Временный бан (300/600/1800 сек)|
|!бан @ник [причина]|Модераторы|Перманентный бан с указанием причины|

### Интерактивные команды
|Команда|Алиасы|Описание|
|:-:|:-:|:-:|
|!iq|!айкью, !icq|Случайный IQ 1-250 с историей|
|!игра|-|Текущая игра стрима (или "Стрим не в эфире")|
|!followage|!подписка, !отслеживание|Время отслеживания канала|
|!чебыло|-|История категорий стрима|
|!7тв|-|Ссылки на расширение 7TV|
|!пинг|-|Задержка ответа бота|
|!э|-|Ответ "ало нормально работаем"|
|!тг|-|Ссылка на Telegram (из .env)|
|!правила|!rules|Правила чата|
|!подарок|-|Случайный подарок|
|!+подарок [название]|-|Добавить новый подарок (только модераторы/стример)|
|!команды|-|Список доступных команд|

### Специальные команды

|Команда|Доступ|Описание|
|:-:|:-:|:-:|
|!сбросить_подарки|Стример|Сброс кэша подарков|
|!тест [сообщение]|Все|Отправляет указанное сообщение в чат (для отладки)|

## Структура проекта
twitch-bot/

├── bot.js # Основной файл бота

├── commands/

│ ├── aliases.js # Алиасы команд

│ ├── api.js # Прямые вызовы Twitch Helix API

│ ├── bannedWords.js # Список запрещённых слов (редактируется)

│ ├── interactive.js # Обработчики интерактивных команд

│ └── moderation.js # Логика модерации (варны, спам, капс)

├── utils.js # Вспомогательные функции (API-запросы, форматирование)

├── database.js # Работа с SQLite

├── package.json

├── package-lock.json

├── .env # Конфигурация (не в репозитории!)

├── .env.example # Пример конфигурации

├── .gitignore

├── check_git.js # Скрипт проверки Git

├── README.md

└── bot_database.db # SQLite база данных (создаётся автоматически)


## Разработка

### Установка для разработки

- Клонирование

```git clone https://github.com/ваш-логин/twitch-bot.git```

```cd twitch-bot```

- Установка зависимостей
  
```npm install```

- Запуск в режиме разработки
  
```npm install -g nodemon```

```nodemon bot.js```

### Тестирование

Проверка синтаксиса

```node -c bot.js```

Запуск тестовой среды

```DEBUG=true node bot.js```

### Расширение функционала

Чтобы добавить новую команду:

- Добавьте алиас в `commands/aliases.js`

- Создайте функцию в `commands/interactive.js` (или в `moderation.js` для модераторских команд)

- Добавьте вызов в `userHandlers` или `modHandlers` в `bot.js`

## Безопасность

### Важные меры предосторожности

- Никогда не коммитьте .env файл

- Регулярно обновляйте токены

- Используйте разные токены для разработки и продакшена

- Отзывайте скомпрометированные токены немедленно

### Файл .gitignore

> .env
> 
> *.db
> 
> node_modules/
> 
> logs/

### База данных

Бот использует SQLite для хранения:

- user_iq — IQ пользователей

- violations — история нарушений

- spam_tracking — статистика спама

- stream_sessions — сессии стримов

- stream_categories — история категорий

## Вклад в проект

Мы приветствуем вклад в развитие бота!

1. Форкните репозиторий

2. Создайте ветку для вашей функции (git checkout -b feature/amazing-feature)

3. Сделайте коммит изменений (git commit -m 'Add amazing feature')

4. Запушьте в ветку (git push origin feature/amazing-feature)

5. Откройте Pull Request

Альтернативно можно поддержать на [канале](https://www.twitch.tv/cluelesstech98)

### Лицензия

Распространяется под лицензией MIT, смотрите [Лицензия MIT](#Лицензия-MIT) для подробностей

### Поддержка

Если у вас возникли проблемы:

1. Проверьте, что токены актуальны и имеют нужные scopes

2. Убедитесь, что бот добавлен как модератор в канал

3. Проверьте логи в консоли на наличие ошибок

4. Попробуйте послать разработчика куда подальше и перепишите код с нуля

5. ???


### Примечание: Обязательно замените ваш-логин на ваш GitHub username и заполните .env файл своими данными Twitch API.

### Приятного пользования!

### Последнее обновление: 23.02.2026 

### Я чуть позже перепишу readme, пиздец как впалду описывать то говно, что я сделал в последнем апдейте
