# Чат-бот для Twitch с продвинутой модерацией и интерактивными командами

Разработан для twitch.tv/cluelesstech98 с учетом особенностей канала

**Версия 1.2.2**

## Содержание
1. [Отказ от ответственности](#отказ-от-ответственности)
   1. [Юридические аспекты](#юридические-аспекты)
   2. [Технические предупреждения](#технические-предупреждения)
   3. [Ответственность пользователя](#ответственность-пользователя)
   4. [Лицензирование и использование](#лицензирование-и-использование)
2. [Особенности](#особенности)
3. [Быстрый старт](#быстрый-старт)
4. [Список команд](#список-команд)
5. [Разработка](#разработка)
6. [Безопасность](#безопасность)
7. [Вклад в проект](#вклад-в-проект)

---

# Отказ от ответственности
## ⚠️ ВАЖНО: ПРОЧТИТЕ ПЕРЕД ИСПОЛЬЗОВАНИЕМ ⚠️

## Юридические аспекты

### Это **неофициальный** проект

> [!WARNING]
> Данный бот НЕ является продуктом или сервисом компании Twitch Interactive, Inc. (Amazon.com, Inc.), это независимый проект с открытым исходным кодом.

### Соблюдение правил Twitch

> [!WARNING]
> Вы обязаны соблюдать Условия использования Twitch, Сообществодские правила и все применимые законы вашей страны.

### Ответственность за контент

> [!WARNING]
> Пользователь бота несёт полную ответственность за:
>
> - Контент, генерируемый или распространяемый через бота
> - Действия бота в чате канала
> - Последствия использования команд модерации

## Технические предупреждения

### Отсутствие гарантий

> [!WARNING]
> Бот предоставляется "как есть", без каких-либо гарантий, но обратная связь присутствует.
> 
> Личные файлы намеренно не публикуются в открытом доступе из соображений безопасности.
>
> Авторы не несут ответственности за:
> 
> - Потерю/утечку данных
> - Блокировку канала Twitch
> - Технические сбои и ошибки в работе
> - Ущерб, причинённый использованием бота

### Безопасность токенов

> [!CAUTION]
> ⚠️ НИКОГДА НЕ ДЕЛИТЕСЬ СВОИМИ ТОКЕНАМИ Twitch API. Храните `ACCESS_TOKEN` и `CLIENT_ID` в секрете, утечка токенов может привести к компрометации вашего аккаунта Twitch ⚠️

### Настройка фильтров

> [!WARNING]
> Вы самостоятельно настраиваете фильтры запрещённых слов и правил модерации. Убедитесь, что они соответствуют:
>
> - Правилам Twitch
> - Законам вашей страны
> - Локальным требованиям платформы

## Ответственность пользователя

### Тестирование

> [!WARNING]
> Перед использованием на основном канале протестируйте бота:
> 
> - На тестовом канале
> - В различных сценариях
> - С разными типами пользователей

### Мониторинг

> [!WARNING]
> Рекомендуется регулярно:
>
> - Проверять логи бота
> - Обновлять токены доступа
> - Следить за изменениями в Twitch API
> - Обновлять список запрещённых слов

> [!IMPORTANT]
> Не рекомендуется:
>
> - Использовать не по назначению
> - Оставлять без присмотра
> - Игнорировать ошибки
> - Вписывать неприемлимые слова в текст кода (за исключением /bannedWords.js)
> - Напрягать разработчика

### Возрастные ограничения

> [!WARNING]
> Использование бота подразумевает, что вы:
> 
> - Достигли возраста, разрешённого для использования Twitch (13+ лет)
>   (В тексте кода может присутствовать ненормативная лексика, 18+)
> - Имеете право управлять Twitch каналом (от лица владельца или модератора канала)
> - Понимаете риски использования сторонних ботов

## Лицензирование и использование

### Лицензия MIT

> [!WARNING]
> Проект распространяется под лицензией MIT, что означает:
> 
> - Вы можете свободно использовать, изменять и распространять код
> - Авторы не несут ответственности за последствия использования
> - Вы обязаны сохранять уведомление об авторских правах

### Используя этот бот, вы подтверждаете, что:

> [!WARNING]
> - Прочитали и однозначно поняли данный отказ от ответственности
> - Принимаете на себя все риски, связанные с использованием
> - Обязаны соблюдать правила Twitch и местное законодательство
> - Несёте полную ответственность за действия бота на канале

### Условная рекомендация

> [!IMPORTANT]
> Перед публичным использованием проконсультируйтесь с юристом относительно соответствия вашей деятельности местному законодательству и правилам Twitch

---

## Особенности

### Прямая интеграция с Twitch Helix API
- Команды модерации (`!варн`, `!таймаут`, `!бан`) работают через официальный API Twitch, что гарантирует стабильность и соответствие последним требованиям платформы

### Автоматическая модерация
- Фильтр запрещённых слов – мгновенный таймаут за использование запрещённых слов (список настраивается в `src/commands/bannedWords.js`)
- Капс-детектор – система двух предупреждений, затем таймаут
- Анти-спам – обнаружение и наказание за повторяющиеся сообщения
- Система предупреждений (`!варн`) – три предупреждения → автоматический таймаут

### Интерактивные команды
- `!iq` – случайный IQ с сохранением истории в базе данных
- `!игра` – отображение текущей игры (или "Стрим не в эфире")
- `!followage` – время отслеживания канала (разные форматы для стримера, модераторов, зрителей)
- `!чебыло` – история категорий текущего стрима с продолжительностью
- `!команды` – вывод списка доступных команд
- `!подарок` – случайный подарок с механикой "бан-подарка" (для модераторов и стримера без ограничений)
- `!+подарок` – добавление нового подарка (только модераторы/стример)
- `!-подарок` – сброс кэша подарков (только стример)

### Новые команды (v1.2.0)
- `!предложение [игра]` – предложить игру для голосования на следующий стрим
- `!голос [игра]` – отдать голос за предложенную игру (один голос за стрим)
- `!итоги` – показать результаты голосования и статистику текущего стрима
- `!пословица [слово]` – случайная пословица с подстановкой указанного слова
- `!рулетка` – игровой автомат с тремя эмодзи; при совпадении всех трёх – выигрыш 10 очков бота
- `!баллы` / `!очки` – показать текущее количество очков пользователя

### Очки бота
- Начисляются за активность (команды, участие в голосовании, выигрыш в рулетке)
- В будущем планируется обмен на бонусы канала

### Хранение данных
- SQLite база данных – сохраняет IQ пользователей, историю нарушений, категории стримов, предложенные игры, голоса, очки, пословицы
- Кэширование запросов (NodeCache) – оптимизация работы с Twitch API
- Журналирование – детальные логи для отладки

## Быстрый старт

### Предварительные требования

- **Node.js** (версия 16 или выше) — [официальный сайт](https://nodejs.org/) 
- **Git** 
- Аккаунт на Twitch и доступ к [консоли разработчика](https://dev.twitch.tv/console/apps)

### Установка и запуск

1. **Получите код бота**  
   - **Способ А (через Git):** откройте командную строку (терминал) и выполните:
     ```bash
     git clone https://github.com/ваш-логин/twitch-bot.git
     cd twitch-bot
     ```
   - **Способ Б (без Git):** скачайте архив с репозитория (зелёная кнопка «Code» → «Download ZIP»), распакуйте его в удобную папку и откройте терминал в этой папке

2. **Установите зависимости**  
   В терминале выполните команду:
   ```bash
   npm install
3. **Переименуйте .env.example -> .env**
Замените своими данными:
- ACCESS_TOKEN=ваш_токен_бота
- CLIENT_ID=ваш_client_id
- BOT_USERNAME=имя_бота
- CHANNEL_NAME=ваш_канал

4. **Запустите бота**
- node src/bot.js
- проверьте наличие data/bot_database.db
- выдайте статус модератора через /mod 
- протестируйте

### Авторская ремарка

Данный проект может быть реализован как бот с ответом от лица стримера или модератора канала. Инструкции по умолчанию подразумевают аккаунт модератора. Для запуска от лица стримера замените BOT_USERNAME на название канала и используйте токен стримера, ВСЕГДА следите за действиями, которые выполняет кусок-какого-то-кода

> ВНИМАНИЕ: Для обеспечения безопасности Вашего канала не рекомендуется использование от лица стримера

## Список команд

### Команды модерации (доступны модераторам и стримеру)

- !варн @ник – Система предупреждений (3 предупреждения → таймаут)
- !timeout @ник секунды – Временный мут
- !бан @ник [причина] – Перманентный бан с указанием причины

### Интерактивные команды (доступны всем)

- !iq / !айкью / !icq – Случайный IQ 1-250 с историей
- !игра – Текущая игра стрима (или "Стрим не в эфире")
- !followage / !подписка / !отслеживание – Время отслеживания канала
- !чебыло – История категорий текущего стрима
- !7тв – Ссылки на расширение 7TV
- !пинг – Задержка ответа бота
- !э – Команда тестирования
- !тг – Ссылка на Telegram (из .env)
- !правила / !rules – Правила чата
- !подарок – Случайный подарок (для модераторов и стримера без ограничений)
- !+подарок [название] – Добавить новый подарок (только модераторы/стример)
- !-подарок – Сброс кэша подарков (только стример)
- !команды – Список доступных команд

### Новые интерактивные команды в версии 1.2.0 (доступны всем) 

- !предложение [игра] – Предложить игру для голосования
- !голос [игра] – Проголосовать за игру (один голос за стрим)
- !итоги – Итоги голосования и статистика стрима
- !пословица [слово] – Случайная пословица с вашим словом // допиливается
- !рулетка – Игровой автомат (три эмодзи, выигрыш 10 очков)
- !баллы / !очки – Показать свои очки бота


## Разработка

### Установка для разработки

git clone https://github.com/ваш-логин/twitch-bot.git
cd twitch-bot
npm install

Для автоматического перезапуска при изменениях используйте nodemon:

npm install -g nodemon
npm run dev

### Тестирование

Проверка синтаксиса:
node -c src/bot.js

Запуск с детальными логами:
DEBUG=true node src/bot.js

### Расширение функционала

Чтобы добавить новую команду:
1. Добавьте алиас в src/commands/aliases.js
2. Создайте функцию-обработчик в соответствующем файле (interactive.js для пользовательских команд, moderation.js для модераторских)
3. Добавьте вызов в userHandlers или modHandlers в src/bot.js

## Безопасность

### Важные меры предосторожности
- Никогда не коммитьте файл .env и базу данных *.db – они уже в .gitignore
- Регулярно обновляйте токены (ACCESS_TOKEN)
- Используйте разные токены для разработки и продакшена
- При компрометации токена немедленно отзовите его в консоли разработчика (https://dev.twitch.tv/console/apps)

# Зависимости
node_modules/

# Файлы окружения
config/.env
config/.env.*
.env

# База данных
data/*.db
*.db

# Логи
*.log
npm-debug.log*

### База данных

Бот использует SQLite для хранения:
- user_iq – IQ пользователей
- violations – история нарушений
- spam_tracking – статистика спама
- stream_sessions – сессии стримов
- stream_categories – история категорий
- stream_games – предложенные игры для голосования
- votes – голоса пользователей
- bot_points – очки бота
- proverbs – шаблоны пословиц

## Вклад в проект

Мы приветствуем вклад в развитие бота!

1. Форкните репозиторий
2. Создайте ветку для вашей функции (git checkout -b feature/amazing-feature)
3. Сделайте коммит изменений (git commit -m 'Add amazing feature')
4. Запушьте в ветку (git push origin feature/amazing-feature)
5. Откройте Pull Request

Альтернативно можно поддержать проект на [канале](https://www.twitch.tv/cluelesstech98)

### Поддержка

Если у вас возникли проблемы:
1. Проверьте, что токены актуальны и имеют нужные scopes (особенно channel:moderate)
2. Убедитесь, что бот добавлен как модератор в канал (команда /mod имя_бота)
3. Проверьте логи в консоли на наличие ошибок
4. Попробуйте перезапустить бота
5. Если ничего не помогает – прокляните разработчика и напишите ему, пусть поможет
6. ...?
7. Грац, всё работает!

### Приятного пользования!

Руки разработчика --> Cluelesstech@yandex.ru <-- бить или целовать

Последнее обновление: 25.02.2026
Релиз v1.2.2: 26.02.2026
