# Чат-бот для Twitch с продвинутой модерацией и интерактивными командами

Разработан специально для www.twitch.tv/cluelesstech98 с учетом особенностей канала


НО с этого момента можно подставить свои значения и будет хихи-хаха, плюс подшаманить личные команды и всё

**Версия 1.2.0**

## Содержание
1. [Отказ от ответственности](#отказ-от-ответственности)
   1. [Юридические аспекты](#юридические-аспекты)
   2. [Технические предупреждения](#технические-предупреждения)
   3. [Ответственность пользователя](#ответственность-пользователя)
   4. [Лицензирование и использование](#лицензирование-и-использование)
2. [Особенности](#особенности)
3. [Быстрый старт](#быстрый-старт)
4. [Настройка](#настройка)
5. [Добавление бота в чат](#добавление-бота-в-чат)
6. [Список команд](#список-команд)
7. [Структура проекта](#структура-проекта)
8. [Разработка](#разработка)
9. [Безопасность](#безопасность)
10. [Вклад в проект](#вклад-в-проект)

---

# Отказ от ответственности
## ⚠️ ВАЖНО: ПРОЧТИТЕ ПЕРЕД ИСПОЛЬЗОВАНИЕМ ⚠️

## Юридические аспекты

### Это **неофициальный** проект

> [!WARNING]
> Данный бот НЕ является продуктом или сервисом компании Twitch Interactive, Inc. (Amazon.com, Inc.), это независимый проект с открытым исходным кодом.

### Соблюдение правил Twitch

> [!WARNING]
> Вы обязаны соблюдать Условия использования Twitch, Сообществодские правила и все применимые законы вашей страны.

### Ответственность за контент

> [!WARNING]
> Пользователь бота несёт полную ответственность за:
>
> - Контент, генерируемый или распространяемый через бота
> - Действия бота в чате канала
> - Последствия использования команд модерации

## Технические предупреждения

### Отсутствие гарантий

> [!WARNING]
> Бот предоставляется "как есть", без каких-либо гарантий, но обратная связь присутствует.
> 
> Личные файлы намеренно не публикуются в открытом доступе из соображений безопасности.
>
> Авторы не несут ответственности за:
> 
> - Потерю/утечку данных
> - Блокировку канала Twitch
> - Технические сбои и ошибки в работе
> - Ущерб, причинённый использованием бота

### Безопасность токенов

> [!CAUTION]
> ⚠️ НИКОГДА НЕ ДЕЛИТЕСЬ СВОИМИ ТОКЕНАМИ Twitch API. Храните `ACCESS_TOKEN` и `CLIENT_ID` в секрете, утечка токенов может привести к компрометации вашего аккаунта Twitch ⚠️

### Настройка фильтров

> [!WARNING]
> Вы самостоятельно настраиваете фильтры запрещённых слов и правил модерации. Убедитесь, что они соответствуют:
>
> - Правилам Twitch
> - Законам вашей страны
> - Локальным требованиям платформы

## Ответственность пользователя

### Тестирование

> [!WARNING]
> Перед использованием на основном канале протестируйте бота:
> 
> - На тестовом канале
> - В различных сценариях
> - С разными типами пользователей

### Мониторинг

> [!WARNING]
> Рекомендуется регулярно:
>
> - Проверять логи бота
> - Обновлять токены доступа
> - Следить за изменениями в Twitch API
> - Обновлять список запрещённых слов

### Возрастные ограничения

> [!WARNING]
> Использование бота подразумевает, что вы:
> 
> - Достигли возраста, разрешённого для использования Twitch (13+ лет)
>   (В тексте кода присутствует ненормативная лексика, 18+)
> - Имеете право управлять Twitch каналом (от лица владельца или модератора канала)
> - Понимаете риски использования сторонних ботов

## Лицензирование и использование

### Лицензия MIT

> [!WARNING]
> Проект распространяется под лицензией MIT, что означает:
> 
> - Вы можете свободно использовать, изменять и распространять код
> - Авторы не несут ответственности за последствия использования
> - Вы обязаны сохранять уведомление об авторских правах

### Используя этот бот, вы подтверждаете, что:

> [!WARNING]
> - Прочитали и однозначно поняли данный отказ от ответственности
> - Принимаете на себя все риски, связанные с использованием
> - Обязаны соблюдать правила Twitch и местное законодательство
> - Несёте полную ответственность за действия бота на канале

### Условная рекомендация

> [!IMPORTANT]
> Перед публичным использованием проконсультируйтесь с юристом относительно соответствия вашей деятельности местному законодательству и правилам Twitch.

---

## Особенности

### Прямая интеграция с Twitch Helix API
- Команды модерации (`!варн`, `!таймаут`, `!бан`) работают через официальный API Twitch, что гарантирует стабильность и соответствие последним требованиям платформы.

### Автоматическая модерация
- Фильтр запрещённых слов – мгновенный таймаут за использование запрещённых слов (список настраивается в `src/commands/bannedWords.js`).
- Капс-детектор – система двух предупреждений, затем таймаут.
- Анти-спам – обнаружение и наказание за повторяющиеся сообщения.
- Система предупреждений (`!варн`) – три предупреждения → автоматический таймаут.

### Интерактивные команды
- `!iq` – случайный IQ с сохранением истории в базе данных.
- `!игра` – отображение текущей игры (или "Пока не играем" / "Стрим не в эфире").
- `!followage` – время отслеживания канала (разные форматы для стримера, модераторов, зрителей).
- `!чебыло` – история категорий текущего стрима с продолжительностью.
- `!команды` – вывод списка доступных команд.
- `!подарок` – случайный подарок с механикой "бан-подарка" (для модераторов и стримера без ограничений).
- `!+подарок` – добавление нового подарка (только модераторы/стример).
- `!-подарок` – сброс кэша подарков (только стример).

### Новые команды (голосование, развлечения)
- `!предложение [игра]` – предложить игру для голосования на следующий стрим.
- `!голос [игра]` – отдать голос за предложенную игру (один голос за стрим).
- `!итоги` – показать результаты голосования и статистику текущего стрима.
- `!пословица [слово]` – случайная пословица с подстановкой указанного слова.
- `!рулетка` – игровой автомат с тремя эмодзи; при совпадении всех трёх – выигрыш 10 очков бота.
- `!баллы` / `!очки` – показать текущее количество очков пользователя.

### Очки бота
- Начисляются за активность (команды, участие в голосовании, выигрыш в рулетке).
- В будущем планируется обмен на бонусы канала.

### Хранение данных
- SQLite база данных – сохраняет IQ пользователей, историю нарушений, категории стримов, предложенные игры, голоса, очки, пословицы.
- Кэширование запросов (NodeCache) – оптимизация работы с Twitch API.
- Журналирование – детальные логи для отладки.

## Быстрый старт

### Предварительные требования

- Node.js 16.x или выше
- Git
- Аккаунт Twitch с доступом к Developer Console (https://dev.twitch.tv/console/apps)
- Двухфакторная аутентификация аккаунта

### Установка за пару кликов

1. Клонируйте репозиторий
   git clone https://github.com/ваш-логин/twitch-bot.git
   cd twitch-bot

2. Установите зависимости
   npm install

3. Настройте окружение
   cp config/.env.example config/.env
   Отредактируйте config/.env своими данными (см. раздел Настройка).

4. Запустите бота
   node src/bot.js
   или через npm-скрипт:
   npm start

---

## Настройка

1. Перейдите на сайт генератора токенов (https://twitchtokengenerator.com/) (может потребоваться VPN).
2. Нажмите кнопку Generate Token.
3. Авторизуйтесь через аккаунт вашего бота (не стримера!).
4. Выберите необходимые разрешения (scopes):
   - chat:read – чтение чата
   - chat:edit – отправка сообщений
   - channel:moderate – модерация (таймауты, баны)
   - moderator:manage:banned_users – управление банами через API
   - moderator:manage:chat_messages – удаление сообщений
   - user:read:email – получение email (опционально)
5. Скопируйте сгенерированный Access Token и Client ID.

### Конфигурация .env (в папке config/)

ACCESS_TOKEN=ваш_access_token_бота

CLIENT_ID=ваш_client_id

BOT_USERNAME=имя_бота

CHANNEL_NAME=ваш_канал

TELEGRAM_LINK=ссылка_на_telegram (опционально)

BACKUP_CHANNEL_CREATION_DATE=2020-01-01 (резервная дата создания канала)

DEBUG=true

LOG_LEVEL=info


## Добавление бота в чат

В вашем Twitch чате выполните:

/mod имя_вашего_бота

После подключения бот не отправляет приветственных сообщений – это нормально. Проверьте работоспособность командой !пинг.

### Авторская ремарка

Данный проект может быть реализован как бот с ответом от лица стримера или модератора канала. Инструкции по умолчанию настроены для аккаунта модератора. Для запуска от лица стримера замените BOT_USERNAME на имя канала и используйте токен стримера, ВСЕГДА следите за действиями, которые выполняет кусок-какого-то-кода

> ВНИМАНИЕ: Для обеспечения безопасности Вашего канала не рекомендуется использование от лица стримера.

## Список команд

### Команды модерации (доступны модераторам и стримеру)

- !варн @ник – Система предупреждений (3 предупреждения → таймаут)
- !timeout @ник секунды – Временный бан (от 1 до 1209600 секунд)
- !бан @ник [причина] – Перманентный бан с указанием причины

### Интерактивные команды (доступны всем)

- !iq / !айкью / !icq – Случайный IQ 1-250 с историей
- !игра – Текущая игра стрима (или "Стрим не в эфире")
- !followage / !подписка / !отслеживание – Время отслеживания канала
- !чебыло – История категорий текущего стрима
- !7тв – Ссылки на расширение 7TV
- !пинг – Задержка ответа бота
- !э – Ответ "ало нормально работаем"
- !тг – Ссылка на Telegram (из .env)
- !правила / !rules – Правила чата
- !подарок – Случайный подарок (для модераторов и стримера без ограничений)  // в разработке
- !+подарок [название] – Добавить новый подарок (только модераторы/стример)  // в разработке
- !-подарок – Сброс кэша подарков (только стример)  // в разработке
- !команды – Список доступных команд

### Новые интерактивные команды (доступны всем)

- !предложение [игра] – Предложить игру для голосования
- !голос [игра] – Проголосовать за игру (один голос за стрим)
- !итоги – Итоги голосования и статистика стрима
- !пословица [слово] – Случайная пословица с вашим словом // в разработке
- !рулетка – Игровой автомат (три эмодзи, выигрыш 10 очков)
- !баллы / !очки – Показать свои очки бота

## Структура проекта

twitch-bot/
├── src/                          # Исходный код

│   ├── commands/                 # Обработчики команд

│   │   ├── aliases.js            # Алиасы команд

│   │   ├── bannedWords.js        # Список запрещённых слов

│   │   ├── interactive.js        # Интерактивные команды

│   │   └── moderation.js         # Логика модерации

│   ├── services/                  # Бизнес-логика и внешние сервисы

│   │   ├── api.js                 # Прямые вызовы Twitch Helix API

│   │   ├── database.js            # Работа с SQLite

│   │   ├── viewerStatus.js        # Определение статуса зрителя

│   │   ├── voting.js              # Голосование за игры

│   │   ├── points.js              # Очки бота

│   │   ├── proverbs.js            # Пословицы

│   │   └── roulette.js            # Рулетка

│   ├── utils/                     # Вспомогательные функции

│   │   └── utils.js                # Форматирование, API-запросы

│   └── bot.js                      # Главный файл бота

├── config/                         # Конфигурация

│   ├── .env                        # Файл с токенами (не в репозитории!)

│   ├── .env.example                # Пример конфигурации

│   └── .gitignore

├── data/                           # Данные

│   └── bot_database.db              # SQLite база данных (создаётся автоматически)

├── docs/                            # Документация

│   ├── README.md                    # Этот файл

│   └── CHANGELOG.md                 # История изменений

├── scripts/                         # Вспомогательные скрипты

│   └── check_git.js                  # Скрипт проверки Git

├── package.json

├── package-lock.json

└── future.txt                        # Планы развития (опционально)

## Разработка

### Установка для разработки

git clone https://github.com/ваш-логин/twitch-bot.git
cd twitch-bot
npm install

Для автоматического перезапуска при изменениях используйте nodemon:

npm install -g nodemon
npm run dev

### Тестирование

Проверка синтаксиса:
node -c src/bot.js

Запуск с детальными логами:
DEBUG=true node src/bot.js

### Расширение функционала

Чтобы добавить новую команду:
1. Добавьте алиас в src/commands/aliases.js.
2. Создайте функцию-обработчик в соответствующем файле (interactive.js для пользовательских команд, moderation.js для модераторских).
3. Добавьте вызов в userHandlers или modHandlers в src/bot.js.

## Безопасность

### Важные меры предосторожности
- Никогда не коммитьте файл .env и базу данных *.db – они уже в .gitignore.
- Регулярно обновляйте токены (ACCESS_TOKEN).
- Используйте разные токены для разработки и продакшена.
- При компрометации токена немедленно отзовите его в консоли разработчика (https://dev.twitch.tv/console/apps).

### Файл .gitignore

# Зависимости
node_modules/

# Файлы окружения
config/.env
config/.env.*
.env

# База данных
data/*.db
*.db

# Логи
*.log
npm-debug.log*

### База данных

Бот использует SQLite для хранения:
- user_iq – IQ пользователей.
- violations – история нарушений.
- spam_tracking – статистика спама.
- stream_sessions – сессии стримов.
- stream_categories – история категорий.
- stream_games – предложенные игры для голосования.
- votes – голоса пользователей.
- bot_points – очки бота.
- proverbs – шаблоны пословиц.

## Вклад в проект

Мы приветствуем вклад в развитие бота!

1. Форкните репозиторий.
2. Создайте ветку для вашей функции (git checkout -b feature/amazing-feature).
3. Сделайте коммит изменений (git commit -m 'Add amazing feature').
4. Запушьте в ветку (git push origin feature/amazing-feature).
5. Откройте Pull Request.

Альтернативно можно поддержать проект на канале (https://www.twitch.tv/cluelesstech98).

### Лицензия

Распространяется под лицензией MIT. Подробности см. в разделе Лицензия MIT.

### Поддержка

Если у вас возникли проблемы:
1. Проверьте, что токены актуальны и имеют нужные scopes (особенно channel:moderate).
2. Убедитесь, что бот добавлен как модератор в канал (команда /mod имя_бота).
3. Проверьте логи в консоли на наличие ошибок.
4. Попробуйте перезапустить бота.
5. Если ничего не помогает – прокляните разработчика и напишите ему в личные сообщения, пусть поможет
6. ...?
7. Грац, всё работает!

### Приятного пользования!

Руки разработчика --> Cluelesstech@yandex.ru <-- бить или целовать

Последнее обновление: 23.02.2026
